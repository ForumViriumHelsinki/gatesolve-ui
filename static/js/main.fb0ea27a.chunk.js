(this["webpackJsonpgatesolve-ui"]=this["webpackJsonpgatesolve-ui"]||[]).push([[0],{204:function(t,e,n){t.exports=n.p+"static/media/logo.5d5d9eef.svg"},205:function(t,e,n){t.exports=n(383)},210:function(t,e,n){},260:function(t,e){},262:function(t,e){},293:function(t,e){},298:function(t,e){},308:function(t,e){},309:function(t,e){},381:function(t,e,n){},383:function(t,e,n){"use strict";n.r(e);var o=n(7),a=n.n(o),i=n(201),r=n.n(i),c=(n(210),n(107)),u=n(41),l=n(15),s=n(79),p=(n(213),{id:"route-line",type:"line",paint:{"line-opacity":.5,"line-width":5}}),d={id:"route-point",type:"circle",paint:{"circle-radius":5,"circle-color":["get","color"]},filter:["==","Point",["geometry-type"]]},f=n(108),g=function(t){var e=t.height,n=void 0===e?"50":e,o=t.style,i=void 0===o?{fill:"#444",stroke:"none"}:o;return a.a.createElement("svg",{height:n,style:i,viewBox:"0 0 15 15"},a.a.createElement("path",{d:"M7.5 0C5.068 0 2.23 1.486 2.23 5.27c0 2.568 4.054 8.244 5.27 9.73c1.081-1.486 5.27-7.027 5.27-9.73C12.77 1.487 9.932 0 7.5 0z"}))},h=function(t){var e=t.pin,n=e.height,o=void 0===n?"50":n,i=Object(f.a)(e,["height"]),r=t.marker;return a.a.createElement(s.b,Object.assign({},r,{offsetLeft:-o/2,offsetTop:-o}),a.a.createElement(g,Object(u.a)({height:o},i)))},m=n(8),v=n.n(m),y=n(203),b=n(64);function w(t){var e=[];return t.legs[0].getSteps().forEach((function(t){e.push([t.startLocation.longitude,t.startLocation.latitude]),e.push([t.stopLocation.longitude,t.stopLocation.latitude])})),e}function E(t,e,n){return{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"LineString",coordinates:n},properties:{color:"#000"}},{type:"Feature",geometry:{type:"Point",coordinates:[t[1],t[0]]},properties:{color:"#00f"}},{type:"Feature",geometry:{type:"Point",coordinates:[e[1],e[0]]},properties:{color:"#0f0"}}]}}function j(t,e,n){(function(t){var e,n,o=new URL("https://overpass-api.de/api/interpreter");return o.searchParams.append("data",(e=t[0],n=t[1],"\n  [out:json][timeout:25];\n  (\n    relation(around:10, ".concat(e,", ").concat(n,")[building];\n    way(r);\n    way(around:10, ").concat(e,", ").concat(n,")[building];\n  )->.b;\n  // gather results\n  (\n    node(w.b)[entrance];\n  );\n  // print results\n  out body;\n  >;\n  out skel qt;\n"))),fetch(o.toString()).then((function(t){return t.json().then((function(t){return t.elements.filter((function(t){return"node"===t.type&&"lat"in t&&null!=t.lat&&"lon"in t&&null!=t.lon&&t.tags&&t.tags.entrance}))}))}))})(e).then((function(t){return t.length?t:[{id:-1,type:"node",lat:e[0],lon:e[1]}]})).then((function(e){e.forEach((function(e){var o=new b.FlexibleTransitPlanner;o.query({from:{latitude:t[0],longitude:t[1]},to:{latitude:e.lat,longitude:e.lon},roadNetworkOnly:!0}).take(1).on("data",function(){var a=Object(y.a)(v.a.mark((function a(i){var r,c,u;return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,o.completePath(i);case 2:r=a.sent,c=w(r),u=E(t,[e.lat,e.lon],c),n(u);case 6:case"end":return a.stop()}}),a)})));return function(t){return a.apply(this,arguments)}}())}))}))}var O=n(204),L=n.n(O),k=(n(381),[60.17,24.94]),x=[60.18,24.95],C={origin:k,destination:x,route:E(k,x,[]),viewport:{latitude:60.17,longitude:24.94,zoom:14,bearing:0,pitch:0}},P=function(){var t=Object(o.useState)(C),e=Object(l.a)(t,2),n=e[0],i=e[1];return Object(o.useEffect)((function(){i((function(t){return Object(u.a)({},t,{route:E(n.origin,n.destination,[])})})),j(n.origin,n.destination,(function(t){i((function(e){var o;return n.origin!==e.origin||n.destination!==e.destination?e:((o=t.features).push.apply(o,Object(c.a)(e.route.features)),Object(u.a)({},e,{route:t}))}))}))}),[n.origin,n.destination]),a.a.createElement("div",{"data-testid":"app",className:"App"},a.a.createElement("header",{className:"App-header"},a.a.createElement("img",{src:L.a,className:"App-logo",alt:"logo"})),a.a.createElement(s.d,Object.assign({},n.viewport,{width:"100vw",height:"90vh",mapStyle:"https://raw.githubusercontent.com/HSLdevcom/hsl-map-style/master/simple-style.json",onViewportChange:function(t){return i((function(e){return Object(u.a)({},e,{viewport:t})}))},onClick:function(t){0===t.srcEvent.button&&i((function(e){return Object(u.a)({},e,{destination:[t.lngLat[1],t.lngLat[0]]})}))},onContextMenu:function(t){i((function(e){return Object(u.a)({},e,{origin:[t.lngLat[1],t.lngLat[0]]})})),t.srcEvent.preventDefault()}}),a.a.createElement(s.c,{type:"geojson",data:n.route},a.a.createElement(s.a,p),a.a.createElement(s.a,d)),a.a.createElement(h,{marker:{draggable:!0,onDragEnd:function(t){i((function(e){return Object(u.a)({},e,{origin:[t.lngLat[1],t.lngLat[0]]})}))},longitude:n.origin[1],latitude:n.origin[0]},pin:{style:{fill:"#00f"}}}),a.a.createElement(h,{marker:{draggable:!0,onDragEnd:function(t){i((function(e){return Object(u.a)({},e,{destination:[t.lngLat[1],t.lngLat[0]]})}))},longitude:n.destination[1],latitude:n.destination[0]},pin:{style:{fill:"#0f0"}}})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(a.a.createElement(P,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[205,1,2]]]);
//# sourceMappingURL=main.fb0ea27a.chunk.js.map